<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
		<title>Le GitOps dont vous Ãªtes le hÃ©ros</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/night.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

		<!-- Fixme mettre au centre le header -->
		<style>
			body, .reveal {
				background-image: url(images/slide-background.png);
				background-size: auto 100%;
				background-repeat: no-repeat;
			}
			.reveal li {
				font-size: 0.9em;
			}
			.reveal table th, .reveal table td {
				border-bottom: none;
			}
			.left {
				text-align: left;
				padding-left: 20px;
				padding-right: 20px;
			}
			.right {
				text-align: right;
				padding-left: 20px;
				padding-right: 20px;
			}
			.avatar {
				min-width: 7em;
			}
			.header {				
				padding: 10px;
				text-align: center;
				font-size: 66%;
			}
			.header-inner {				
				display: inline-block;
				padding: 10px;
			}
			.very-small {
				font-size: 0.4em;
			}
			.small {
				font-size: 0.8em;
			}
			.big {
				font-size: 2em;
			}
			.img-rounded {
  				border-radius: 50%;
			}
			.reveal .aligncenter {
				margin: 10px auto 20px;
    			display: block;
			}
			.hide {
				display: none;
				visibility: hidden;
			}
			.show {
				visibility: visible;
			}
			.finish {
				color: red;
				font-weight: bold;
				font-size:24px;
			}
			.alerte {
				color: red;
				font-weight: bold;
			}
			.warning {
				color: coral;
			}
			.lvl-up {
				position: absolute;
				box-sizing: border-box;
				top: 20%;
				left: 50%;
				text-align: center;
				transform: translate(-50%, -50%);
				font-size: 200%;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="header">
				<div id="timer" class="header-inner">â³...</div>
				<div id="label-container" class="header-inner"></div>
			</div>
			<div class="slides">

				<div id="label-level" class="lvl-up hide">ğŸ†™</div>

				<!-- 0 -->
				<section>
					<h1>Le GitOps dont vous Ãªtes le hÃ©ros</h1><br/ >
					<img src="images/jdr.png" /><br>
					Une collection Folio DevOps
					<br />
					<br />
					<p class="small">
					Revue des lecteurs sur openfeedback https://bit.ly/3bWs4Qk 
					</p>
					<aside class="notes">
						
					</aside>
				</section>
				<!-- 1 -->
				<section>
					<img src="images/twitter.png" style="margin: 0;" /><span style="font-size: 1.2em;"> @_louidji</span>
					<table class="small">
						<tbody>
							<tr>
								<td><img src="images/louis.png" class="img-rounded aligncenter avatar"/></td>
							</tr>
							<tr>
								<td>Louis Tournayre @ Zenika Lyon</td>
							</tr>
						</tbody>
					</table>
					<br>
					<aside class="notes">
					</aside>
				</section>
				<!-- 2 -->
				<section>
					<h3>Notre histoire commence par une crise...</h3>
					<img src="images/404.png" />
					<br />
					Il Ã©tait une fois une application que nous appellerons <b>le site</b> (et pas le sith)<br />
					<br />
					Mais ce site est dÃ©fectueux, les utilisateurs ne sont pas contents, la direction est inquiÃ¨te...<br />
					
					<aside class="notes">
						Et pire que tout on a dÃ©jÃ  dÃ©ployer le thÃ¨me d'halloween aprÃ¨s halloween, on a pas le droit de faire pareil pour le thÃ¨me de NoÃ«l.<br />
						C'est la crise !
						<br/ >
						La direction attends des idÃ©es et propositions pour amÃ©liorer les choses.<br />
						Vous avez un sprint soit 40 min pour rÃ©soudre cela... 
					</aside>
				</section>

				<!-- 3 -->
				<section>
					<!-- 3.0 -->
					<section data-background-image="images/tarot-divinatoire.png" data-background-size="65%">
						<h3>Table ronde des Ã©quipes</h3>
						ScÃ©ances de brainstorming des diffÃ©rentes Ã©quipes pour trouver des solutions.
						<aside class="notes">
							Ayant dÃ©jÃ  Ã©puisÃ© la pseudo solution de la recherche du coupable on essaye autre chose.
						</aside>
					</section>
					<!-- 3.1 -->
					<section>
						<h3>ğŸ’¡ Comment avoir moins de bugs ?</h3>
						<br />
						<p>
							<ul>
								<li>Des livraison avec moins de choses</li>
								<li>Du temps pour effacer la dette technique</li>
							</ul>
						</p>
						<p>
							Pour que ce soit le plus efficient, il faut que les dÃ©ploiement soient un non Ã©venements.
						</p>
						<aside class="notes">
							CotÃ© dev & projet
						</aside>
					</section>
					<!-- 3.2 -->
					<section>
						<h3>ğŸ’¡ Comment rendre les dÃ©ploiements ?</h3>
						<br />
						<p>
							Fiable, Rapides, AutomatisÃ©s, ğŸ ...<br />
							Il faut revoir le processus de mise en production ğŸ˜°<br />
						</p>
						<br />
						<p>
							Chercher des idÃ©es :
							<ul>
								<li><a href="#/4/1">Discuter avec des amis Ã  la machine Ã  cafÃ© â˜• (ou la taverne)</a></li>
								<li><a href="#/4/2">Chez mon ami google</a></li>
							</ul>
						</p>
						<aside class="notes">
							Faut que j'aille trouver l'inspiration
						</aside>
					</section>
				</section>
				
				<!-- 4 -->
				<section>
					<!-- 4.0 -->
					<section>
						<h3>Perdu ?</h3>
						Vous n'avez rien Ã  faire lÃ 
						
						<aside class="notes">
						</aside>
					</section>
					<!-- 4.1 -->
					<section data-background-image="images/tavern.png" data-background-size="80%">
						<h3>La taverne</h3>
						<br />
						<p>
						Vous rencontrez vos amis Gandalf et Gimli au â˜•.
						Ils vous proposent la solution suivante :
						</p>
						<ul>
							<li>Packager et distribuer l'application via des images docker</li>
							<li>Et le dÃ©ployer dans kubernetes en utilisant les principes <b>GitOps</b></li>
						</ul>
						<br />
						<br />
						Mais c'est quoi <b>GitOps</b> ?...<br />
						Pour en savoir plus <a href="#/5">rendez-vous au meetup du coin</a>
						
						<aside class="notes">
							(En faite c'est la salle cafÃ©/thÃ©/... en fonction de l'heure)
							Et comment on passe d'une image dans un repository Ã  une application dans kube de maniÃ¨re fiable, rapides et automatisÃ©s
							? <br />
							LÃ  le mot GitOps est lachÃ©<br /> 
							Besoin d'apprendre, de s'entrainer ?
						</aside>
					</section>
					<!-- 4.2 -->
					<section>
						<h3>Let Me Google That</h3>
						<img src="images/google.png" /> <br />
						Trop de pistes... se rendre <a href="#/4/1">Ã  la taverne</a>
						<aside class="notes">
							Dont au moins une de trop...
						</aside>
					</section>
				</section>

				<!-- 5 -->
				<section data-background-image="images/richardson-kubecon-2.png" data-background-size="60%">
					<section>
						<!-- TODO GDG Lille  -->
						<h3>Une prÃ©sentation de Legolas sur GitOps Ã  un petit meetup</h3>
						Vous croisez Legolas aprÃ¨s sa prÃ©sentation, vous pouvez <a href="#/5/1">discuter avec lui (A)</a> ou <a href="#/9">aller directement au moment d'Ã©change post meetup (B)</a>
						<aside class="notes">
							Il vous pose quelques questions pour vous aider Ã  comprendre GitOps
						</aside>
					</section>
					<section>
						<h3>Un petit quizz pour vous situer</h3>
						Legolas aimerait savoir ce que vous avez compris, Ã  la fois pour amÃ©liorer sa prÃ©sentation et pour aider Ã  bien apprÃ©hender le concept<br />
						<ul>
							<li><a href="javascript:void(0)" onclick="resolveAndGo('#/5/3', 1, 1)">A: Un plat rÃ©chauffÃ©</a></li>
							<li><a href="#/5/2">B: Un truc rÃ©volutionnaire</a></li>
							<li><a href="#/5/2">C: Une nouvelle destination pour vos vacances</a></li>
							<li><a href="#/5/2">D: Un nouveau framework web</a></li>
						</ul>
						<aside class="notes">
						
						</aside>
					</section>
					<section>
						<h3>Fail</h3>
						<br />
						<a href="#/6">Aller Ã  l'Ã©preuve 2</a>
						<aside class="notes">
						GitOps n'a rien de nouveau, les objectifs et principes mis en Å“uvre dans GitOps existaient bien avant que le terme ne
						soit inventÃ©...<br />
						Mais ce terme Ã  la mode a permis de renouveler et de diffuser cette pratique. Ce terme est aussi liÃ© avec
						de nouveau outils mais GitOps ne veut pas dire nÃ©cessairement nouveaux outils
						</aside>
					</section>
					<section>
						<h3>Win</h3>
						<br />
						<a href="#/6">Aller Ã  l'Ã©preuve 2</a>
						<aside class="notes">
						</aside>
					</section>
				</section>

				<!-- 6 -->
				<section data-background-image="images/richardson-kubecon-2.png" data-background-size="60%">
					<section>
						<h3>Quelles sont les 2 principes fondamentaux de GitOps ?</h3>
						<p>
							<ul>
								<li><a href="#/6/1">A: Le principe, c'est de faire des valeurs</a></li>
								<li><a href="#/6/1">B: On ne passe les commandes Git qu'en ligne de commande</a></li>
								<li><a href="javascript:void(0)" onclick="resolveAndGo('#/6/2', 1, 1)">C: Git est la seul source de vÃ©ritÃ©</a></li>
								<li><a href="#/6/1">D: Chaque branche Git correspond Ã  un environnement diffÃ©rent</a></li>
								<li><a href="javascript:void(0)" onclick="resolveAndGo('#/6/3', 1, 1)">E: Tout est dÃ©crit via du code versionnÃ©</a></li>
								<li><a href="#/6/1">F: Le monde se divise en deux catÃ©gories : ceux qui ont un pistolet chargÃ© et ceux qui creusent. Toi, tu creuses. â›ï¸</a></li>
							</ul>
						</p>
						<br />
						<a href="#/7">Aller Ã  l'Ã©preuve 3</a>
						<aside class="notes">
							C & E permet dâ€™opÃ©rer lâ€™infrastructure en modifiant le code versionnÃ© dans Git
						</aside>
					</section>
					<section>
						<h3>Fail</h3>
						<br />
						<a href="#/6">revenir</a>
						<aside class="notes">
						</aside>
					</section>
					<section>
						<h3>Win</h3>
						<br />
						<a href="#/6">revenir</a>
						<aside class="notes">
							Quelle est lâ€™outil majoritairement utilisÃ© pour stocker, versioner, auditer et partager du code : git
						</aside>
					</section>
					<section>
						<h3>Win</h3>
						<br />
						<a href="#/6">revenir</a>
						<aside class="notes">
							Dans lâ€™IT toutes applications, infrastructures, tests, ... est dÃ©finie par quelque chose dâ€™interprÃ©table par une machine
							: donc par du code (et si ce nâ€™est pas le cas pb). Et le YAML câ€™est aussi du code ;)
						</aside>
					</section>
				</section>

				<!-- 7 -->
				<section data-background-image="images/richardson-kubecon-2.png" data-background-size="60%">
					<section>
						<h3>Quâ€™est ce qui est dÃ©crit dans nos repo Git ?</h3>
						<p>
						<ul>
							<li><a href="#/7/1">A: Du YAML et rien que du YAML</a></li>
							<li><a href="javascript:void(0)" onclick="resolveAndGo('#/7/2', 1, 1)">B: L'Ã©tat dÃ©sirÃ© de lâ€™infrastructure</a></li>
							<li><a href="#/7/1">C: Des scripts qui mettent Ã  jours l'infrastructure</a></li>
							<li><a href="#/7/1">D: Des images de chats en ASCII ART ï¼ˆï¼â—•Ï‰â—•ï¼œï¼‰</a></li>
						</ul>
						</p>
						<aside class="notes">
						</aside>
					</section>
					<section>
						<h3>Fail</h3>
						<a href="#/8">Aller Ã  l'Ã©preuve 4</a>
						<aside class="notes">
							Nous exprimons lâ€™Ã©tat dÃ©sirÃ© que doivent avoir nos infrastructures sous une forme lisible par une machine.<br />
							Il y aura donc un outil qui sâ€™assurera que lâ€™Ã©tat dÃ©sirÃ© et la rÃ©alitÃ© de notre SI convergent. Cet outil va Ãªtre branchÃ©
							sur git. Il pourra Ãªtre notifiÃ© des changements et les rÃ©cupÃ©rer ou aller rÃ©guliÃ¨rement rÃ©cupÃ©rer ces changements.<br />
							<br />
							Un script ne pourra pas avoir toutes les combinatoires possible pour passer d'un Ã©tat Ã  un autre, alors qu'une
							machine pourra calculer les opÃ©ration Ã  faire pour passer d'un Ã©tat Ã  un autre<br />
							La notion d'Ã©tat dÃ©sirÃ© permet en outre de dÃ©tecter des divergences entre l'Ã©tat dÃ©sirÃ© et l'Ã©tat rÃ©el
						</aside>
					</section>
					<section>
						<h3>Win</h3>
						<a href="#/8">Aller Ã  l'Ã©preuve 4</a>
						<aside class="notes">
							Cela permettra d'avoir un outil qui sâ€™assurera que lâ€™Ã©tat dÃ©sirÃ© et la rÃ©alitÃ© de notre SI convergent. Cet outil va Ãªtre branchÃ©
							sur git. Il pourra Ãªtre notifiÃ© des changement et les rÃ©cupÃ©rer ou aller rÃ©guliÃ¨rement rÃ©cupÃ©rer ces changements.
						</aside>
					</section>
				</section>


				<!-- 8 -->
				<section data-background-image="images/richardson-kubecon-2.png" data-background-size="60%">
					<section>
						<h3>Est-ce que je peux opÃ©rer mon infrastructure sans passer par Git ?</h3>
						<p>
							<ul>
								<li><a href="javascript:void(0)" onclick="resolveAndGo('#/8/2', 1, 1)">A: Le monde se divise en deux catÃ©gories : ceux qui ont un pistolet chargÃ© et ceux qui creusent. Toi, tu creuses ta tombe si tu touches Ã  la main Ã  l'infra.</a></li>
								<li><a href="#/8/1">B: Bien sur, I am Groot</a></li>
							</ul>
						</p>
						<aside class="notes">
						</aside>
					</section>
					<section>
						<h3>Fail</h3>
						<a href="#/9">Aller au moment d'Ã©change post meetup</a>
						<aside class="notes">
						</aside>
					</section>
					<section>
						<h3>Win</h3>
						<a href="#/9">Aller au moment d'Ã©change post meetup</a>
						<aside class="notes">
						</aside>
					</section>
				</section>

				<!-- 9 -->
				<section data-background-image="images/tavern.png" data-background-size="80%">
					<section>
						<h3>Au final GitOps c'est...</h3>
						<img src="images/gitops-ring.png" /><br />
						Un repo pour les gouverner tous. Un repo pour les dÃ©tailler. Un repo pour les amener tous et dans kube les
						dÃ©ployer....<br />
						<aside class="notes">
						</aside>
					</section>
					<section>
						<h3>La taverne</h3>
						Vous vous attablez avec Gimli, Legolas et ğŸ»<br />
						Vous leur demandez de l'aide pour mettre en place GitOps dans votre projet <br />
						<ul>
							<li><a href="#/10">A: Legolas vous propose son arme favorite : Argo CD</a></li>
							<li><a href="#/11">B: Alors que Gimli vous conseil d'utiliser votre forge pour faire votre arme sur mesure</a></li>
						</ul>
						<br />
						<br />
						Dans tous les cas, Gandalf vous rejoint et vous offre un cluster kube pour pouvoir dÃ©ployer.
						
						<aside class="notes">
							(Gandalf a crÃ©er le cluster) <br />
							Maintenant il va falloir choisir l'outil ou crÃ©er l'outil. Plusieurs solutions possible : utiliser Argo CD ou crÃ©er sont propre outils
						</aside>
					</section>
				</section>

				<!-- 10 -->
				<section>
					<section>
						<h3>Argo CD</h3>
						<blockquote style="margin-top: 0; margin-bottom: 0; align-content: center;">
							<p style="margin-top: 0">Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes.</p>
							<img src="images/argocd_architecture.png" style="margin-bottom: 0;"/>
						</blockquote>
						https://argoproj.github.io/cd
						<aside class="notes">
						DonnÃ© Ã  la CNCF depuis 2 ans, en status incubator<br />
						Repos github avec environ 7.000 stars et 1700 forks<br />
						En plus de Argo CD il y a plusieurs projets "Argo"=> Workflow : moteur de worflow; Rollout: deployement en blue-green,
						canary, ...; Events : event driven workflow
						</aside>
					</section>
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Votre premiÃ¨re mission</h3>
						<br />
						<ul>
							<li>Installer et configurer Argo CD</li>
							<li>S'assurer que la ligne de commande fonctionne</li>
							<li>S'assurer que l'interface web est accessible au travers d'un Ingress</li>
						</ul><br />
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/12', 1, 3)">AprÃ¨s avoir rÃ©solu cette issue, passer Ã  la prochaine</a>

						<aside class="notes">
							Pour la dÃ©mo tout sera fait en local et l'on aura un seul cluster kube qui hÃ©bergera Argo CD et les dÃ©ployements
						</aside>
					</section>
					
				</section>

				<!-- 11 -->
				<section>
					<section>
						<h3>Script dans GitLab</h3>
						<aside class="notes">
						</aside>
					</section>

					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Votre premiÃ¨re mission</h3>
						<br />
						<ul>
							<li>Installer et configurer un runner GitLab pour dans le cluster</li>
							<li>S'assurer que le runner fonctionne</li>
							<li>Permettre au runner de se connecter Ã  l'API Server</li>
						</ul><br />
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/12', 1, 4)">AprÃ¨s avoir rÃ©solu cette issue, passer Ã  la prochaine</a>
					
						<aside class="notes">
							Pour la dÃ©mo tout sera fait en local et l'on aura un seul cluster kube qui hÃ©bergera GitLab et les dÃ©ployements
						</aside>
					</section>
				</section>

				<!-- 12 -->
				<section>
					<section>
						<h3>DÃ©ployer en production depuis la branche main</h3>
						<br />
						Allons nous enfin pouvoir <a href="#/12/1">dÃ©ployer la production Ã  partir du repository git</a> ? ğŸ¤
						<aside class="notes">
							On va commencer avec un un simple manifest qui sera fournit
						</aside>
					</section>
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Go to prod un vendredi ğŸ˜± ?</h3>
						<br />
						L'Ã©quipe dev vous a fournit les manifests pour dÃ©ployer la nouvelle version de l'application dans la nouvelle infrastructure.<br />
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/13', 1, 3)">AprÃ¨s avoir rÃ©solu cette issue, passer Ã  la prochaine</a>
						
						<aside class="notes">
							Pour la dÃ©mo tout sera fait en local et l'on aura un seul cluster kube qui hÃ©bergera GitLab et les dÃ©ployements<br />
							Si version gitlab il faudra ajouter les scripts prÃ©vu pour...
						</aside>
					</section>

				</section>

				<!-- 13 -->
				<section>
					<section>
						<h3>DÃ©ployer la recette</h3>
						<br />
						<span class="big">ğŸ‘¯â€â™‚ï¸</span> <br />
						Vous pouvez maintenant dÃ©ployer en production directement depuis git<br />
						<br />
						AprÃ¨s cette courte pÃ©riode d'Ã©phorie, un nouveau besoin Ã©merge !<br />
						Ce serait bien de pouvoir faire pareil pour les autres environnements.
						<br /><br />
						<a href="#/13/1">Aller trouver l'inspiration Ã  la taverne...</a>
						<aside class="notes">
							Non seulement ce serait bien mais ce serait indispensable, vous ne voyer pas gÃ©rer diffÃ©rent process de deployement. <br/>
							Mais cela pose pas mal de questions : comment gÃ©rer les diffÃ©rents env ? =>
						</aside>
					</section>
					<!-- 13/1 -->
					<section data-background-image="images/tavern.png" data-background-size="80%">
						<h3>Quel modÃ¨le de configuration pour gÃ©rer nos diffÃ©rents environnements ?</h3>
						<br />
						AprÃ¨s avoir offert plusieurs ğŸº au barde, il vous compte l'histoire de :
						<br />
						<p>
							<ul>
								<li><a href="#/13/2">A: Kustomize, le guerrier Nain qui refuse le templating</a></li>
								<li><a href="#/13/5">B: Helm, le dÃ©mon du templating go</a></li>
							</ul>
						</p>
						<br />
						Qui sera votre modÃ¨le ?
						<aside class="notes">
							Vous Ãªtes sÃ»r Public ?
						</aside>
					</section>
					<!-- 13/2 -->
					<section data-background-image="images/erebor.png" data-background-size="77%">
						<h3>Kustomize</h3>
						<br />
						Une approche dÃ©clarative et sans template.<br />
						<pre>

	â”œâ”€â”€ base
	â”‚Â Â  â”œâ”€â”€ deployment.yml
	â”‚Â Â  â”œâ”€â”€ ingress.yml
	â”‚Â Â  â”œâ”€â”€ kustomization.yml
	â”‚Â Â  â””â”€â”€ svc.yml
	â””â”€â”€ overlays
		â”œâ”€â”€ moria
		â”‚Â Â  â”œâ”€â”€ patch.yml
		â”‚Â Â  â””â”€â”€ kustomization.yml
		â”œâ”€â”€ erebor
		â”‚Â Â  â”œâ”€â”€
		...

						</pre>
						<aside class="notes">
							Les environnements sont representÃ©s par des dossiers dans overlays (mais on peut organiser cela autrement)
						</aside>
					</section>
					<!-- 13/3 -->
					<section data-background-image="images/erebor.png" data-background-size="77%">
						<h3>Kustomize</h3>
						<br />
						Contenant les dÃ©finitions de "base" et le(s) patch(s) de chaque environnement<br />
						<pre>
							<code data-line-numbers="4-5|6-8|9-12|21-22|19-20,23-24">
								<script type="text/template">
								---
								# base kustomize.yml file
								apiVersion: kustomize.config.k8s.io/v1beta1
								kind: Kustomization
								commonLabels:
									app: kustomize
									version: demo02
								resources:
								- deployment.yml
								- svc.yml
								- ingress.yml

								---
								# overlay kustomize.yml file for moria env
								apiVersion: kustomize.config.k8s.io/v1beta1
								kind: Kustomization
								namespace: moria
								commonLabels:
									env: moria
								bases:
								- ../../base
								patchesStrategicMerge:
								- patch.yml
								</script>
							</code>
						</pre>
						<aside class="notes">
							La base et la notion de surcharge sous la forme de fichier(s) de patch sont pilotÃ©s par des fichiers <b>kustomize.yml</b>
						</aside>
					</section>
					<!-- 13/4 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Les mains dans la camboui : Kustomize</h3>
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/14', 1, 3)">AprÃ¨s avoir rÃ©solu cette issue, passer Ã  la prochaine</a>
					</section>
						<!-- 13/5 helm -->
						<section data-background-image="images/balrog.png" data-background-size="77%">
							<h3>Helm</h3>
							<br />
							<q>The package manager for Kubernetes</q> (https://helm.sh/)<br />
							
							<span class="very-small">mais aussi <q>L'enfer est pavÃ© de bonnes intentions</q> (Saint-Bernard)</span>
							<br />
							<p>
							Helm, c'est Ã  la fois un systÃ¨me de :<br />
							<ul>
								<li><a href="#/13/6">templating go pour yaml,</a></li> 
								<li>un systÃ¨me de packaging et de partage d'applications kubernetes</li>
								<li>et un systÃ¨me de gestion de dÃ©pendances entre applications kube.</li>
							</ul>
							</p>
							<aside class="notes">
								Amibitieu et complexe<br />
								Avec un lourd passif avec Tiller ğŸ˜±<br />
								OÃ¹ il faut aimer le templating GO<br />
								Mais c'est votre choix
							</aside>
						</section>
						<!-- 13/6 -->
						<section data-background-image="images/balrog.png" data-background-size="77%">
							<h3>Helm create</h3>
							Un <b>Chart helm</b> cela ressemble Ã  quoi ?<br />
							<pre>
				â”œâ”€â”€ charts
				â”œâ”€â”€ Chart.yaml
				â”œâ”€â”€ templates
				â”‚Â Â  â”œâ”€â”€ deployment.yaml
				â”‚Â Â  â”œâ”€â”€ _helpers.tpl
				â”‚Â Â  â”œâ”€â”€ hpa.yaml
				â”‚Â Â  â”œâ”€â”€ ingress.yaml
				â”‚Â Â  â”œâ”€â”€ NOTES.txt
				â”‚Â Â  â”œâ”€â”€ serviceaccount.yaml
				â”‚Â Â  â”œâ”€â”€ service.yaml
				â”‚Â Â  â””â”€â”€ tests
				â”‚Â Â  â””â”€â”€ test-connection.yaml
				â””â”€â”€ values.yaml
							</pre>
							<aside class="notes">
								Les descripteurs des diffÃ©rents composants sont initializÃ©s par dÃ©faut.<br />
								Ainsi qu'un fichier <b>values.yaml</b> avec les valeurs par dÃ©faut des templates.
							</aside>
						</section>
						<!-- 13/7 -->
						<section data-background-image="images/balrog.png" data-background-size="77%">
							<h3>Helm</h3>
							<pre>
								<code data-line-numbers="1-3|30,34|53|30,36-37,40|78">
									<script type="text/template">
										## Chart.yaml file
										apiVersion: v2
										name: balrog
										description: A Helm chart for Kubernetes

										# A chart can be either an 'application' or a 'library' chart.
										#
										# Application charts are a collection of templates that can be packaged into versioned archives
										# to be deployed.
										#
										# Library charts provide useful utilities or functions for the chart developer. They're included as
										# a dependency of application charts to inject those utilities and functions into the rendering
										# pipeline. Library charts do not define any templates and therefore cannot be deployed.
										type: application

										# This is the chart version. This version number should be incremented each time you make changes
										# to the chart and its templates, including the app version.
										# Versions are expected to follow Semantic Versioning (https://semver.org/)
										version: 0.1.0

										# This is the version number of the application being deployed. This version number should be
										# incremented each time you make changes to the application. Versions are not expected to
										# follow Semantic Versioning. They should reflect the version the application is using.
										# It is recommended to use it with quotes.
										appVersion: "1.16.0"
										
										---
										## values.yaml file
										# Default values for balrog.
										# This is a YAML-formatted file.
										# Declare variables to be passed into your templates.

										replicaCount: 1

										image:
										repository: registry.acdc.song/highway/to-hell
										pullPolicy: IfNotPresent
										# Overrides the image tag whose default is the chart appVersion.
										tag: "666"
										# ...

										---
										## deployement.yml file
										apiVersion: apps/v1
										kind: Deployment
										metadata:
										name: {{ include "balrog.fullname" . }}
										labels:
											{{- include "balrog.labels" . | nindent 4 }}
										spec:
										{{- if not .Values.autoscaling.enabled }}
										replicas: {{ .Values.replicaCount }}
										{{- end }}
										selector:
											matchLabels:
											{{- include "balrog.selectorLabels" . | nindent 6 }}
										template:
											metadata:
											{{- with .Values.podAnnotations }}
											annotations:
												{{- toYaml . | nindent 8 }}
											{{- end }}
											labels:
												{{- include "balrog.selectorLabels" . | nindent 8 }}
											spec:
											{{- with .Values.imagePullSecrets }}
											imagePullSecrets:
												{{- toYaml . | nindent 8 }}
											{{- end }}
											serviceAccountName: {{ include "balrog.serviceAccountName" . }}
											securityContext:
												{{- toYaml .Values.podSecurityContext | nindent 8 }}
											containers:
												- name: {{ .Chart.Name }}
												securityContext:
													{{- toYaml .Values.securityContext | nindent 12 }}
												image: "{{ .Values.image.repository }}:{{ .Values.image.tag | default .Chart.AppVersion }}"
										# ...

									</script>
								</code>
							</pre>
							<aside class="notes">
								La base et la notion de surcharge sous la forme de fichier(s) de patch sont pilotÃ©s par des fichiers
								<b>kustomize.yml</b>
							</aside>
						</section>


						<!-- 13/8 -->
						<section data-background-image="images/des.png" data-background-size="50%">
							<h3>Les mains dans la camboui : Helm</h3>
							<br />
							<a href="javascript:void(0)" onclick="resolveAndGo('#/14', 1, 5)">AprÃ¨s avoir rÃ©solu cette issue, passer Ã  la prochaine</a>
							<aside class="notes">
							</aside>
						</section>
					
				</section>

				<!-- 14 -->
				<section>
					<section data-background-image="images/secret.png" data-background-size="60%">
						<h3>L'application prÃ©sente des failles</h3>
						<br />
						Entre autre, les secrets sont directement dans l'application.<br />
						<br />
						<a href="#/14/1">Demander Ã  Gandalf s'il connaÃ®t un sort d'externalisation des mots de passe</a>
						<aside class="notes">
						</aside>
					</section>
					<section data-background-image="images/tavern.png" data-background-size="80%">
						<h3>La voie du silence</h3>
						Heureusement, Gandalf est lÃ  et vous donne plusieurs directions, choisissez bien...<br />
						<br />
						<ul>
							<li><a href="#/14/2">A: Les "secrets" natifs de kube</a></li>
							<li><a href="#/14/3">B: Le chiffrage dans Git avec bitnami sealed secrets</a></li>
							<li><a href="#/14/4">C: La solution la plus avancÃ©e : Hashicorp Vault</a></li>
							<li><a href="#/16">D: J'ai pas l'temps, pas l'choix faut y aller... ğŸƒ</a></li>
						</ul>
						<aside class="notes">
						</aside>
					</section>
					<section data-background-image="images/secret.png" data-background-size="60%">
						<h3>Les "Secret" selon Kubernetes ğŸ¤¡</h3>
						ğŸš¨ Encoder n'est pas chiffrer<br />
						<pre>
							<code data-line-numbers="4">---
apiVersion: v1
data:
	password: RW5jb2RlciBuJ2VzdCBwYXMgY2hpZmZyZXI=
kind: Secret
metadata:
	name: it-s-a-joke
							</code>
						</pre>
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/15', 1, -2)">AprÃ¨s avoir rÃ©solu cette issue, passer Ã  la prochaine</a>
						<aside class="notes">
							Mais bon, cela rÃ©pond au premier besoin d'externalisation. AprÃ¨s si kustomize on peut utiliser un generator
						</aside>
					</section>
					<section data-background-image="images/secret.png" data-background-size="60%">
						<h3>Sealed Secrets</h3>
						<br />
						Utilise un chiffrement asymÃ©trique
						<br />
						<img src="images/crypto-asymetric-fr.png" />
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/15', 1, 3)">AprÃ¨s avoir rÃ©solu cette issue, passer Ã  la prochaine</a>
						<aside class="notes">
							https://github.com/bitnami-labs/sealed-secrets
						</aside>
					</section>
					<section data-background-image="images/secret.png" data-background-size="60%">
						<h3>Hashicorp Vault</h3>
						<p>
							On peut utiliser Vault depuis notre l'endroit qui dÃ©ploie grace Ã  :
							<ul class="small">
								<li>Du templating</li>
								<li>Des commandes impÃ©ratifs</li>
							</ul>
						</p>
						<p>
							Ou encore depuis le cluster oÃ¹ les secrets sont utilisÃ©s via :
							<ul class="small">
								<li>Init/SideCar Containers</li>
								<li>IntÃ©grer un client Vault dans l'application</li>
								<li>Utiliser "Secrets Store CSI driver" de kube</li>
							</ul>
						</p>
						<br />
						<p class="small">
							MÃªme si c'est la meilleure solution, vous n'avez pas encore le niveau pour cette epic.<br />
							Ce sera l'objet d'une autre aventure dont vous serez le hÃ©ros...
						</p>
						<a href="#/14/1">revenir en arriÃ¨re</a>
						<aside class="notes">
							Quelque soit la solution choisit il faut bien Ã©videment avoir Vault installÃ©.
							Mais pas le temps/level de mettre cela en place, retour Ã  la case dÃ©part en ayant perdu un peu de temps
						</aside>
					</section>

				</section>

				<!-- 15 -->
				<section data-background-image="images/des.png" data-background-size="50%">
					<h3>DÃ©ployer la prod sur un tag au lieu de HEAD</h3>
					<br />
					Il s'agit de la derniÃ¨re issue. Elle est optionnelle<br />
					<br />
					<ul>
						<li><a href="#/16">J'ai pas l'temps, pas l'choix faut y aller... ğŸƒ</a></li>
						<li><a href="javascript:void(0)" onclick="resolveAndGo('#/16', 1, 3)">Trop fort j'ai eu le temps de la rÃ©soudre</a></li>
					</ul>
					<aside class="notes">
					</aside>
				</section>

				<!-- 16 -->
				<section data-background-image="images/frodo-in-rivendell.png" data-background-size="70%">
					<h3>Questions ?</h3>
					<br />
					Merci Ã  vous ğŸ¤—
					<div id="final-score"></div>
				</section>

				<!-- 17 -->
				<section>
					<h3>FeedBack ğŸ™</h3>
					<p>
					<img src="images/qr-code-open-feedback.png" style="vertical-align: middle;"/><span>   https://bit.ly/3HqdUFC </span>
					</p>
					<h3>RÃ©fÃ©rences ğŸ“–</h3>
					<ul>
						<li>ArgoCD : https://argo-cd.readthedocs.io/en/stable/</li>
						<li>GitLab Runner pour K8S : https://docs.gitlab.com/runner/install/kubernetes.html</li>
						<li>Helm : https://helm.sh/</li>
						<li>Kustomize : https://kustomize.io/ </li>
						<li>Civo : https://www.civo.com/kubernetes</li>
						<li>PrÃ©sentation & code : https://github.com/louiznk/gitops-heros</li>
					</ul>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/highlight/highlight.js"></script>

		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/

			Reveal.initialize({
				hash: true,
				autoPlayMedia: true,

				history: true,

				width: 1400,
				height: 800,

				// Factor of the display size that should remain empty around
				// the content
				margin: 0.04,

				// Bounds for smallest/largest possible scale to apply to content
				minScale: 0.2,
				maxScale: 2.0,

				// Slide number "speaker" : speaker view | "all"
				progress: "all",
				slideNumber: 'c/t',
				showSlideNumber: 'speaker view',

				// 17:30 max sur les slides => 2:00 sur les questions (sur dernier slides) => 19:30
				totalTime: 1170,
				
				// pdf all fragments in the same page
				pdfSeparateFragments: false,
				pdfMaxPagesPerSlide: 1,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealHighlight, RevealNotes ]
			});

		</script>
		<script type="text/javascript" src="js/level.js"></script>
		<script type="text/javascript" src="js/timer.js"></script>
	</body>
</html>
